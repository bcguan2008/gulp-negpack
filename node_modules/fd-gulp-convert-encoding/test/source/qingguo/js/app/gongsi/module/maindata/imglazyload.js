/**
 * Õº∆¨—”≥Ÿº”‘ÿ¿‡
 
 * @author terence.wangt
 * date:2012.05.10
 */
 
!(function($){

	var Sandbox,
		self,
		configs = {
		end:0
	};
		
	function imageLazyLoad(sb) {
		Sandbox = sb;
		return imageLazyLoad;
	}
	
	$.extend(imageLazyLoad,{
				
			init:function(cfg){
							
				self = this;
				this.config = $.extend(false, {}, configs, cfg);
				
				//Õº∆¨—”≥Ÿº”‘ÿƒ£øÈ
				this.registerEvent("#sw_mod_searchlist");
				
				Sandbox.on([Qingguo.Config.Events.BigRender, Qingguo.Config.Events.OfferAsyncOffer], 
					function(data){self.registerEvent("#sw_mod_searchlist");}
				);				
			},

			registerEvent:function(parentId){

				AppCore.lazyRegister("sw-mod-imagelazyload", null, $( parentId+' img[data-lazyload-src]'), 'exposure',{
					keep:true,
					threshold:200,
					callback:function(el){
						src = $(el).attr('data-lazyload-src');
						if(src){
							$(el).attr('src',src);
							$(el).removeAttr('data-lazyload-src');
						}
					}
				});
			},
			
			end:0
	});
	
	Qingguo.Business.imageLazyLoad = imageLazyLoad;	
	AppCore.register("sw_mod_imageLazyLoad", Qingguo.Business.imageLazyLoad);
})(jQuery);