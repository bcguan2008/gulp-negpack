// Generated by CoffeeScript 1.6.2
/*
The last 20 offers in maindata area asyn load
base class
@author dongming.jidm
@date 2012-12-26
*/


(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  (function($) {
    var AsynOffer, QU, defConfigs, win;

    win = window;
    QU = Qingguo.Utility;
    defConfigs = {};
    defConfigs.otherParam = {};
    defConfigs.otherParam.data = {};
    AsynOffer = (function() {
	
      function AsynOffer(configs) {
        this.run = __bind(this.run, this);
        this.renderData = __bind(this.renderData, this);
        this.failCallBack = __bind(this.failCallBack, this);
        this.successCallBack = __bind(this.successCallBack, this);
        this.sendARequest = __bind(this.sendARequest, this);        
		defConfigs.url = configs.url;
        AsynOffer.collectParam();
        defConfigs.otherParam.data.showStyle = configs.showStyle;
        defConfigs.otherParam.success = this.successCallBack;
        defConfigs.otherParam.error = this.failCallBack;
      }

      AsynOffer.prototype.sendARequest = function() {
        QU.getRPCJsonp(defConfigs.url, defConfigs.otherParam);
      };

      AsynOffer.prototype.successCallBack = function(data) {
        this.renderData(data);
        Sandbox.notify(Qingguo.Config.Events.imgLazyLoadInit, null);
      };

      AsynOffer.prototype.failCallBack = function() {};

      /*
      		need to be rerwote in new class
      */


      AsynOffer.prototype.renderData = function(data) {};

      /*
      		collect the parameters for request
      */


      AsynOffer.collectParam = function() {
        var formInput, item, requestData, _i, _len;

        formInput = $("#pageNavForm").serializeArray();
        requestData = {};
        for (_i = 0, _len = formInput.length; _i < _len; _i++) {
          item = formInput[_i];
          requestData[item.name] = item.value;
        }
        /*
        			only need one screen loading
        */

        requestData.loadCount = 1;
        if (win.asynConfig != null) {
          requestData.industry = win.asynConfig.industry;
          requestData.beginPage = win.asynConfig.navigationPage;
        }
        defConfigs.otherParam.data = requestData;
      };

      AsynOffer.prototype.run = function() {
        this.sendARequest();
      };

      return AsynOffer;

    })();
    return Qingguo.Business.AsynOffer = AsynOffer;
  })(jQuery);

}).call(this);
